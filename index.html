<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–±–æ—á–∏—Ö –≤–µ—Å–æ–≤</title>
<style>
:root {
  /* === –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) === */
  --bg-main: linear-gradient(135deg,#333 0%,#1c1c1c 100%);
  --bg-sidebar: #1b1b1b;
  --bg-container: #212121;
  --bg-section: #282828;
  --bg-card: #333;
  --bg-input: #333;
  --bg-table: #444;
  --bg-table-header: #555;

  --text-main: #ddd;
  --text-secondary: #aaa;
  --text-title: #f0f0f0;
  --text-contrast: #fff;

  --border-color: #666;
  --header-bg: linear-gradient(135deg,#444 0%,#333 100%);

  --btn-bg: linear-gradient(135deg,#7f8c8d 0%,#5f6a6a 100%);
  --btn-text: #fff;

  --error-bg: #a60000;
  --error-text: #fff;
}

body.light-theme {
  /* === –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ === */
  --bg-main: linear-gradient(135deg,#f2f2f2 0%,#e8e8e8 100%);
  --bg-sidebar: #eaeaea;
  --bg-container: #fff;
  --bg-section: #f9f9f9;
  --bg-card: #f5f5f5;
  --bg-input: #fff;
  --bg-table: #f5f5f5;
  --bg-table-header: #ddd;

  --text-main: #222;
  --text-secondary: #444;
  --text-title: #111;
  --text-contrast: #000;

  --border-color: #bbb;
  --header-bg: linear-gradient(135deg,#ddd 0%,#bbb 100%);

  --btn-bg: linear-gradient(135deg,#bbb 0%,#999 100%);
  --btn-text: #222;

  --error-bg: #ff5555;
  --error-text: #fff;
}

/* === –û–±—â–∏–π —Å—Ç–∏–ª—å === */
* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: var(--bg-main);
  min-height:100vh; padding:20px;
  display:flex;
  color: var(--text-main);
}

/* === –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é === */
.sidebar {
  width:220px;
  background: var(--bg-sidebar);
  border-radius:10px;
  box-shadow:0 0 15px rgba(0,0,0,0.5);
  padding:15px;
  margin-right:20px;
  height:fit-content;
  position:sticky;
  top:20px;
}
.sidebar h2 {
  font-size:1.3em;
  margin-bottom:10px;
  color: var(--text-title);
  text-align:center;
}
.sidebar ul { list-style:none; }
.sidebar li { margin:8px 0; position:relative; }
.sidebar a {
  display:block;
  padding:10px 12px;
  text-decoration:none;
  color: var(--text-main);
  border-radius:8px;
  transition:background .3s, color .3s;
}
.sidebar a:hover {
  background: var(--bg-card);
  color: var(--text-contrast);
}
/* –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ */
.dropdown > a::after {
  content:"‚ñº";
  float:right;
  font-size:0.8em;
  transition:transform .3s;
}
.dropdown.open > a::after { transform:rotate(-180deg); }
.dropdown ul { display:none; margin-left:10px; }
.dropdown.open ul { display:block; }
.dropdown ul a {
  font-size:0.9em;
  background: var(--bg-section);
}

/* === –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ === */
.container {
  flex:1;
  max-width:1200px;
  background: var(--bg-container);
  border-radius:15px; 
  box-shadow:0 10px 30px rgba(0,0,0,0.7); 
  overflow:hidden;
}
.header {
  background: var(--header-bg);
  color: var(--text-title);
  padding:30px; text-align:center;
  border-bottom:2px solid var(--border-color);
}
.header h1 { font-size:2.5em; margin-bottom:10px; }
.header p { font-size:1.2em; opacity:0.9; }
.input-section { padding:30px; background: var(--bg-section); position:relative; }
.input-grid {
  display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:20px;
  margin-bottom:30px;
}
.input-group {
  background: var(--bg-card);
  padding:20px; border-radius:10px;
  box-shadow:0 2px 10px rgba(0,0,0,0.5);
}
.input-group label {
  display:block; font-weight:bold; margin-bottom:10px;
  color: var(--text-secondary); font-size:1em;
}
.input-group input {
  width:100%; padding:12px;
  border:2px solid var(--border-color);
  border-radius:8px; font-size:16px;
  background: var(--bg-input);
  color: var(--text-main);
  transition:border-color .3s;
}
.input-group input:focus { outline:none; border-color:#7f8c8d; }
.calculate-btn {
  background: var(--btn-bg);
  color: var(--btn-text);
  border:none; padding:15px 30px;
  font-size:18px; border-radius:8px;
  cursor:pointer; transition:transform .2s;
  display:block; margin:0 auto;
}
.calculate-btn:hover { transform:translateY(-2px); }
.results { padding:30px; display:none; background: var(--bg-card); border-radius:10px; }
.exercise-result {
  margin-bottom:24px;
  background: var(--bg-table);
  border-radius:10px; overflow:hidden;
  box-shadow:0 2px 10px rgba(0,0,0,0.5);
}
.exercise-header {
  padding:14px 20px; font-size:1.1em; font-weight:bold;
  color: var(--text-contrast); display:flex; align-items:center; justify-content:space-between;
}
.header-left { display:flex; align-items:center; gap:10px; }
.header-actions { display:flex; gap:8px; align-items:center; }
.small-btn {
  background:transparent; border:1px solid rgba(255,255,255,0.12); padding:6px 10px; border-radius:6px; color:inherit; cursor:pointer;
}
.weight-tables {
  padding:20px; display:grid;
  grid-template-columns:1fr 1fr; gap:20px;
}
.weight-table {
  background: var(--bg-card);
  border-radius:8px; padding:15px;
}
.weight-table h4 {
  margin-bottom:15px; color: var(--text-main); text-align:center;
}
.weight-table table {
  width:100%; border-collapse:collapse;
}
.weight-table th, .weight-table td {
  padding:10px; text-align:center;
  border-bottom:1px solid var(--border-color);
}
.weight-table th {
  background: var(--bg-table-header);
  color: var(--text-contrast);
  font-weight:bold;
}
.emoji { font-size:1.2em; margin-right:10px; }

@media (max-width:768px) {
  body { flex-direction:column; }
  .sidebar { width:100%; margin-bottom:20px; position:static; }
  .weight-tables { grid-template-columns:1fr; }
  .header h1 { font-size:2em; }
}

#error-message {
  opacity:0;
  background-color: var(--error-bg);
  color: var(--error-text);
  padding:12px; margin-bottom:20px;
  border-radius:5px; text-align:center;
  max-width:600px; margin-left:auto; margin-right:auto;
  transition: opacity .4s ease-in-out;
  pointer-events:none; user-select:none;
  box-shadow:0 0 15px rgba(180,0,0,0.9);
  position:relative;
}
#error-message.show { opacity:1; pointer-events:auto; user-select:auto; }

/* === –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã === */
.theme-toggle {
  position: fixed;
  left: 20px; bottom: 20px;
  background: #444;
  color: white;
  border: none;
  border-radius: 50%;
  width: 50px; height: 50px;
  cursor: pointer;
  font-size: 1.4em;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 8px rgba(0,0,0,0.4);
  transition: background .3s, transform .2s;
  z-index: 1000;}
body.light-theme .theme-toggle {
  background: #ddd;
  color: #222;
}
.theme-toggle:hover { transform: translateY(-2px); }

/* custom form styles */
#custom-exercise-form input { margin-bottom:10px; padding:10px; border-radius:6px; border:1px solid var(--border-color); }
#custom-exercise-form { box-shadow:0 5px 20px rgba(0,0,0,0.6); }
.remove-btn { font-size:0.9em; padding:6px 8px; border-radius:6px; cursor:pointer; background:transparent; border:1px solid rgba(255,255,255,0.08); }
.add-exercise-btn {
  background: linear-gradient(135deg, #7f8c8d, #bdc3c7); 
  color: #fff;
  border: none;
  padding: 12px 22px;
  font-size: 16px;
  border-radius: 8px;
  cursor: pointer;
  transition: transform .2s, box-shadow .3s, opacity .3s;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  justify-content: center;
}
.add-exercise-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);
  opacity: 0.95;
}

/* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ ‚Äî –º—è–≥—á–µ –æ—Ç—Ç–µ–Ω–∫–∏ –∑–µ–ª—ë–Ω–æ–≥–æ */
body.light-theme .add-exercise-btn {
  background: linear-gradient(135deg, #2ecc71, #58d68d);
  color: #fff;
}
</style>

</head>
<body>
<!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
  <div class="sidebar">
    <h2>–ú–µ–Ω—é</h2>
    <ul>
      <li><a href='/'>üè† –ì–ª–∞–≤–Ω–∞—è</a></li>
      <li class="dropdown">
        <a href="#">üìÇ –†–∞–∑–¥–µ–ª—ã</a>
        <ul>
          <li><a href='/gum'>–ú–æ—ë —Ç–µ–ª–æ - –∂–µ–ª–µ–∑–æ</a></li>
          <li><a href='/osanka'>–ü–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫ - —Ç–∏—Ç–∞–Ω</a></li>
          <li><a href='/motor'>–°–µ—Ä–¥—Ü–µ - –º–æ—Ç–æ—Ä</a></li>
        </ul>
      </li>
      <li><a href='/about'>‚ÑπÔ∏è –û –ø—Ä–æ–µ–∫—Ç–µ</a></li>
    </ul>
  </div>
  <div class="container">
    <div class="header">
      <h1>üèãüèª –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–±–æ—á–∏—Ö –≤–µ—Å–æ–≤ (v.5.2.1)</h1>
      <p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</p>
      <p>–ü–æ–¥—Å–∫–∞–∑–∫–∞: m(Fe) = 20 –∫–≥</p>
    </div>

    <div class="input-section">
      <div id="error-message">–û—à–∏–±–∫–∞: –≤–µ—Å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω—É–ª–µ–≤—ã–º –∏–ª–∏ –ø—É—Å—Ç—ã–º!</div>

      <div class="input-grid">
        <div class="input-group">
          <label for="deadlift">ü•µ –°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ (–∫–≥):</label>
          <input type="number" id="deadlift" placeholder="0" min="0" max="505" />
        </div>
        <div class="input-group">
          <label for="bench">üí™ –ñ–∏–º –ª–µ–∂–∞ (–∫–≥):</label>
          <input type="number" id="bench" placeholder="0" min="0" max="335" />
        </div>
        <div class="input-group">
          <label for="squat">ü¶µ –ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è (–∫–≥):</label>
          <input type="number" id="squat" placeholder="0" min="0" max="525" />
        </div>
        <div class="input-group">
          <label for="biceps">ü¶æ –ü–æ–¥—ä—ë–º –Ω–∞ –±–∏—Ü–µ–ø—Å (–∫–≥):</label>
          <input type="number" id="biceps" placeholder="0" min="0" max="150" />
        </div>
        <div class="input-group">
          <label for="armypress">üéñÔ∏è –ê—Ä–º–µ–π—Å–∫–∏–π –∂–∏–º (–∫–≥):</label>
          <input type="number" id="armypress" placeholder="0" min="0" max="200" />
        </div>

        <div class="input-group" style="display:flex; align-items:center; justify-content:center;">
  <button type="button" class="add-exercise-btn" onclick="openCustomExerciseForm()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</button>
</div>
      </div>

      <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è -->
      <div id="custom-exercise-form" style="display:none; margin-top:20px; background:var(--bg-card); padding:20px; border-radius:10px;">
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:</label>
        <input type="text" id="custom-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¢—è–≥–∞ –≤ –Ω–∞–∫–ª–æ–Ω–µ" style="width:100%;">
        <label>–≠–º–æ–¥–∑–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
        <input type="text" id="custom-emoji" placeholder="üèπ" style="width:100%;">
        <label>1–ü–ú (–∫–≥):</label>
        <input type="number" id="custom-max" placeholder="0" min="0" style="width:100%;">
        <div style="display:flex; gap:10px; margin-top:8px;">
          <button class="calculate-btn" onclick="addCustomExercise()">–î–æ–±–∞–≤–∏—Ç—å</button>
          <button class="small-btn" onclick="closeCustomExerciseForm()" type="button">–û—Ç–º–µ–Ω–∞</button>
        </div>
      </div>

      <div style="margin-top:18px; text-align:center;">
        <button class="calculate-btn" onclick="calculateWeights()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
      </div>

    </div>

    <div class="results" id="results">
      <div class="exercise-result" id="deadlift-result" style="display:none;">
        <div class="exercise-header deadlift-header">
          <div class="header-left"><span class="emoji">ü•µ</span>–¢–†–ï–ù–ò–†–û–í–ö–ê A - –°–¢–ê–ù–û–í–ê–Ø –¢–Ø–ì–ê</div>
          <div class="header-actions"></div>
        </div>
        <div class="weight-tables">
          <div class="weight-table">
            <h4>–†–∞–∑–º–∏–Ω–æ—á–Ω—ã–µ –≤–µ—Å–∞</h4>
            <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</th></tr></thead><tbody id="deadlift-warmup"></tbody></table>
          </div>
          <div class="weight-table">
            <h4>–†–∞–±–æ—á–∏–µ –≤–µ—Å–∞</h4>
            <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>% –æ—Ç 1–ü–ú</th></tr></thead><tbody id="deadlift-working"></tbody></table>
          </div>
        </div>
      </div>

      <div class="exercise-result" id="bench-result" style="display:none;">
        <div class="exercise-header bench-header">
          <div class="header-left"><span class="emoji">üí™</span>–¢–†–ï–ù–ò–†–û–í–ö–ê B - –ñ–ò–ú –õ–ï–ñ–ê</div>
          <div class="header-actions"></div>
        </div>
        <div class="weight-tables">
          <div class="weight-table">
            <h4>–†–∞–∑–º–∏–Ω–æ—á–Ω—ã–µ –≤–µ—Å–∞</h4>
            <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</th></tr></thead><tbody id="bench-warmup"></tbody></table>
          </div>
          <div class="weight-table">
            <h4>–†–∞–±–æ—á–∏–µ –≤–µ—Å–∞</h4>
            <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>% –æ—Ç 1–ü–ú</th></tr></thead><tbody id="bench-working"></tbody></table>
          </div>
        </div>
      </div>

      <div class="exercise-result" id="squat-result" style="display:none;">
        <div class="exercise-header squat-header">
          <div class="header-left"><span class="emoji">ü¶µ</span>–¢–†–ï–ù–ò–†–û–í–ö–ê C - –ü–†–ò–°–ï–î–ê–ù–ò–Ø</div>
          <div class="header-actions"></div>
        </div>
        <div class="weight-tables">
          <div class="weight-table">
            <h4>–†–∞–∑–º–∏–Ω–æ—á–Ω—ã–µ –≤–µ—Å–∞</h4>
            <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</th></tr></thead><tbody id="squat-warmup"></tbody></table>
          </div>
          <div class="weight-table">
            <h4>–†–∞–±–æ—á–∏–µ –≤–µ—Å–∞</h4>
            <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>% –æ—Ç 1–ü–ú</th></tr></thead><tbody id="squat-working"></tbody></table>
          </div>
        </div>
      </div>

      <div class="exercise-result" id="biceps-result" style="display:none;">
        <div class="exercise-header" style="background: linear-gradient(135deg,#fbc531,#e1b12c); color:#333;">
          <div class="header-left"><span class="emoji">ü¶æ</span>–¢–†–ï–ù–ò–†–û–í–ö–ê D - –ü–û–î–™–Å–ú –ù–ê –ë–ò–¶–ï–ü–°</div>
          <div class="header-actions"></div>
        </div>
        <div class="weight-tables">
          <div class="weight-table">
            <h4>–†–∞–∑–º–∏–Ω–æ—á–Ω—ã–µ –≤–µ—Å–∞</h4>
            <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</th></tr></thead><tbody id="biceps-warmup"></tbody></table>
          </div>
          <div class="weight-table">
            <h4>–†–∞–±–æ—á–∏–µ –≤–µ—Å–∞</h4>
            <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>% –æ—Ç 1–ü–ú</th></tr></thead><tbody id="biceps-working"></tbody></table>
          </div>
        </div>
      </div>
      <div class="exercise-result" id="armypress-result" style="display:none;">
        <div class="exercise-header" style="background: linear-gradient(135deg,#8e44ad,#5e3370); color:white;">
          <div class="header-left"><span class="emoji">üéñÔ∏è</span>–¢–†–ï–ù–ò–†–û–í–ö–ê E - –ê–†–ú–ï–ô–°–ö–ò–ô –ñ–ò–ú</div>
          <div class="header-actions"></div>
        </div>
        <div class="weight-tables">
          <div class="weight-table">
            <h4>–†–∞–∑–º–∏–Ω–æ—á–Ω—ã–µ –≤–µ—Å–∞</h4>
            <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</th></tr></thead><tbody id="armypress-warmup"></tbody></table>
          </div>
          <div class="weight-table">
            <h4>–†–∞–±–æ—á–∏–µ –≤–µ—Å–∞</h4>
            <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>% –æ—Ç 1–ü–ú</th></tr></thead><tbody id="armypress-working"></tbody></table>
          </div>
        </div>
      </div>

      <!-- –∫–∞—Å—Ç–æ–º–Ω—ã–µ –±–ª–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
    </div>
  </div>
<!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã -->
<button class="theme-toggle" onclick="toggleTheme()">üåô</button>

<script>
/* ===================== –õ–æ–≥–∏–∫–∞ —Ç–µ–º—ã ===================== */
function toggleTheme() {
  document.body.classList.toggle("light-theme");
  const isLight = document.body.classList.contains("light-theme");
  localStorage.setItem("theme", isLight ? "light" : "dark");
  document.querySelector(".theme-toggle").textContent = isLight ? "‚òÄÔ∏è" : "üåô";
}

/* ===================== –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è localStorage –∏ id ===================== */
const defaultIds = ["deadlift","bench","squat","biceps","armypress"];
function saveDefaultInputs() {
  defaultIds.forEach(id => {
    const el = document.getElementById(id);
    if (el) localStorage.setItem(id, el.value || "");
  });
}
function restoreDefaultInputs() {
  defaultIds.forEach(id => {
    const el = document.getElementById(id);
    const val = localStorage.getItem(id);
    if (el && val !== null) el.value = val;
  });
}
function saveCustomList(list) {
  try { localStorage.setItem("customExercises", JSON.stringify(list)); } catch(e){}
}
function loadCustomList() {
  try {
    const raw = localStorage.getItem("customExercises");
    return raw ? JSON.parse(raw) : [];
  } catch(e){ return []; }
}
function sanitizeId(name) {
  // –û—Å—Ç–∞–≤–ª—è–µ–º –ª–∞—Ç–∏–Ω–∏—Ü—É, –∫–∏—Ä–∏–ª–ª–∏—Ü—É –∏ —Ü–∏—Ñ—Ä—ã, –∑–∞–º–µ–Ω—è–µ–º –ø—Ä–æ—á–µ–µ –Ω–∞ _
  let base = name.toLowerCase().trim().replace(/[^a-z0-9–∞-—è—ë]+/gi, '_');
  base = base.replace(/^_+|_+$/g, '');
  if (!base) base = 'exercise';
  let id = base;
  let i = 1;
  while (document.getElementById(id + '-result')) {
    id = base + "_" + i;
    i++;
  }
  return id;
}

/* ===================== –†–∞–±–æ—Ç–∞ —Å —Ñ–æ—Ä–º–æ–π –¥–æ–±–∞–≤–ª–µ–Ω–∏—è ===================== */
function openCustomExerciseForm() {
  document.getElementById("custom-exercise-form").style.display = "block";
  document.getElementById("custom-exercise-form").scrollIntoView({behavior:'smooth'});
}
function closeCustomExerciseForm() {
  document.getElementById("custom-exercise-form").style.display = "none";
  document.getElementById("custom-name").value = "";
  document.getElementById("custom-emoji").value = "";
  document.getElementById("custom-max").value = "";
}

/* ===================== –î–æ–±–∞–≤–ª–µ–Ω–∏–µ / —É–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π ===================== */
function addCustomExercise() {
  const name = document.getElementById("custom-name").value.trim();
  const emoji = document.getElementById("custom-emoji").value.trim() || "üèãÔ∏è";
  const oneRM = parseFloat(document.getElementById("custom-max").value);

  if (!name || isNaN(oneRM) || oneRM <= 0) {
    showError("–ù–∞–∑—ã–≤–∞–π –∫–∞–∫ —Ö–æ—á–µ—à—å, –∞ –ø–æ–¥–Ω—è—Ç—å —á—Ç–æ-—Ç–æ –æ–±—è–∑–∞–Ω!");
    return;
  }

  const id = sanitizeId(name);

  const newEx = { id, name, emoji, oneRM };
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
  const list = loadCustomList();
  list.push(newEx);
  saveCustomList(list);

  // –°–æ–∑–¥–∞—ë–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π –±–ª–æ–∫
  createCustomResultBlock(newEx);

  closeCustomExerciseForm();
  document.getElementById('results').style.display = 'block';
  document.getElementById(id + '-result').scrollIntoView({behavior:'smooth'});
}

function createCustomResultBlock(ex) {
  const resultsDiv = document.getElementById("results");

  // –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å —Ç–∞–∫–æ–π –±–ª–æ–∫ (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π), –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
  if (document.getElementById(ex.id + "-result")) return;

  const exerciseDiv = document.createElement("div");
  exerciseDiv.className = "exercise-result";
  exerciseDiv.id = ex.id + "-result";
  exerciseDiv.innerHTML = `
    <div class="exercise-header" style="background:linear-gradient(135deg,#2980b9,#2c3e50); color:white;">
      <div class="header-left"><span class="emoji">${ex.emoji}</span>${escapeHtml(ex.name.toUpperCase())}</div>
      <div class="header-actions">
        <button class="small-btn" title="–£–¥–∞–ª–∏—Ç—å" onclick="removeCustomExercise('${ex.id}')">–£–¥–∞–ª–∏—Ç—å</button>
      </div>
    </div>
    <div class="weight-tables">
      <div class="weight-table">
        <h4>–†–∞–∑–º–∏–Ω–æ—á–Ω—ã–µ –≤–µ—Å–∞</h4>
        <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</th></tr></thead><tbody id="${ex.id}-warmup"></tbody></table>
      </div>
      <div class="weight-table">
        <h4>–†–∞–±–æ—á–∏–µ –≤–µ—Å–∞</h4>
        <table><thead><tr><th>–í–µ—Å (–∫–≥)</th><th>% –æ—Ç 1–ü–ú</th></tr></thead><tbody id="${ex.id}-working"></tbody></table>
      </div>
    </div>
  `;
  resultsDiv.appendChild(exerciseDiv);

  // —Ä–∞—Å—Å—á–∏—Ç–∞–µ–º –ø–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–º—É —à–∞–±–ª–æ–Ω—É
  calculateExercise(ex.id, ex.oneRM,
    [{percent:40,reps:10},{percent:60,reps:6},{percent:70,reps:3}],
    [{percent:65,label:'65% (10-12 –ø–æ–≤—Ç.)'},{percent:70,label:'70% (8-10 –ø–æ–≤—Ç.)'},{percent:75,label:'75% (6-8 –ø–æ–≤—Ç.)'}]
  );
}

function removeCustomExercise(id) {
  if (!confirm("–£–¥–∞–ª–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ?")) return;
  // —É–¥–∞–ª–∏—Ç—å –∏–∑ DOM
  const el = document.getElementById(id + "-result");
  if (el) el.remove();
  // —É–¥–∞–ª–∏—Ç—å –∏–∑ localStorage
  const list = loadCustomList().filter(x => x.id !== id);
  saveCustomList(list);
}

/* ===================== –†–∞—Å—á—ë—Ç—ã ===================== */
function calculateWeights() {
  // –ë–µ—Ä—ë–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ–ª–µ–π
  const inputs = {};
  let anyNonEmpty = false;
  let hasZero = false;

  defaultIds.forEach(id => {
    const el = document.getElementById(id);
    const val = el ? parseFloat(el.value) : NaN;
    if (!isNaN(val) && val > 0) {
      inputs[id] = val;
      anyNonEmpty = true;
    } else if (val === 0) {
      hasZero = true;
    }
  });

  if (!anyNonEmpty && loadCustomList().length === 0) {
    showError("–î–æ—Ä–æ–≥–æ–π, –Ω–µ—Ö–æ–π –ø—É—Å—Ç–æ—Ç—É —Ç—è–≥–∞—Ç—å!");
    return;
  }
  if (hasZero) {
    showError("–ù–æ–ª—å ‚Äî —ç—Ç–æ –Ω–µ –≤–µ—Å, –∞–≥–∞?");
    return;
  }

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–ª—è
  saveDefaultInputs();

  // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–µ—Å–ª–∏ –∑–∞–¥–∞–Ω 1–ü–ú ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±–ª–æ–∫)
  if (inputs.deadlift) {
    calculateExercise('deadlift', inputs.deadlift,
      [{percent:43,reps:8},{percent:57,reps:5},{percent:64,reps:3}],
      [{percent:70,label:'70% (6-10 –ø–æ–≤—Ç.)'},{percent:75,label:'75% (6-8 –ø–æ–≤—Ç.)'},{percent:80,label:'80% (6 –ø–æ–≤—Ç.)'},{percent:82,label:'82% (–º–∞–∫—Å–∏–º—É–º)'}]
    );
    document.getElementById('deadlift-result').style.display='block';
  } else document.getElementById('deadlift-result').style.display='none';

  if (inputs.bench) {
    calculateExercise('bench', inputs.bench,
      [{percent:40,reps:10},{percent:60,reps:6},{percent:70,reps:3}],
      [{percent:70,label:'70% (8-12 –ø–æ–≤—Ç.)'},{percent:75,label:'75% (8-10 –ø–æ–≤—Ç.)'},{percent:80,label:'80% (8 –ø–æ–≤—Ç.)'}]
    );
    document.getElementById('bench-result').style.display='block';
  } else document.getElementById('bench-result').style.display='none';

  if (inputs.squat) {
    calculateExercise('squat', inputs.squat,
      [{percent:40,reps:10},{percent:60,reps:6},{percent:70,reps:3}],
      [{percent:70,label:'70% (8-12 –ø–æ–≤—Ç.)'},{percent:75,label:'75% (8-10 –ø–æ–≤—Ç.)'},{percent:80,label:'80% (8 –ø–æ–≤—Ç.)'}]
    );
    document.getElementById('squat-result').style.display='block';
  } else document.getElementById('squat-result').style.display='none';

  if (inputs.biceps) {
    calculateExercise('biceps', inputs.biceps,
      [{percent:40,reps:10},{percent:60,reps:6},{percent:70,reps:3}],
      [{percent:65,label:'65% (10-12 –ø–æ–≤—Ç.)'},{percent:70,label:'70% (8-10 –ø–æ–≤—Ç.)'},{percent:75,label:'75% (6-8 –ø–æ–≤—Ç.)'}]
    );
    document.getElementById('biceps-result').style.display='block';
  } else document.getElementById('biceps-result').style.display='none';

  if (inputs.armypress) {
    calculateExercise('armypress', inputs.armypress,
      [{percent:40,reps:8},{percent:55,reps:5},{percent:65,reps:3}],
      [{percent:70,label:'70% (8-10 –ø–æ–≤—Ç.)'},{percent:75,label:'75% (6-8 –ø–æ–≤—Ç.)'},{percent:80,label:'80% (5-6 –ø–æ–≤—Ç.)'},{percent:85,label:'85% (3-5 –ø–æ–≤—Ç.)'}]
    );
    document.getElementById('armypress-result').style.display='block';
  } else document.getElementById('armypress-result').style.display='none';

  // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–∫–∞—Å—Ç–æ–º–Ω—ã–µ –±–ª–æ–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å)
  document.getElementById('results').style.display='block';
  document.getElementById('results').scrollIntoView({behavior:'smooth'});
}

function calculateExercise(exercise, oneRM, warmupData, workingData) {
  const warmupTableBody = document.getElementById(exercise + '-warmup');
  if (warmupTableBody) {
    warmupTableBody.innerHTML = '';
    warmupData.forEach(data=>{
      const raw = oneRM * data.percent / 100;
      const weight = Math.round(raw / 2.5) * 2.5;
      warmupTableBody.innerHTML += `<tr><td>${weight} –∫–≥</td><td>${data.reps}</td></tr>`;
    });
  }

  const workingTableBody = document.getElementById(exercise + '-working');
  if (workingTableBody) {
    workingTableBody.innerHTML = '';
    workingData.forEach(data=>{
      const raw = oneRM * data.percent / 100;
      const weight = Math.round(raw / 2.5) * 2.5;
      workingTableBody.innerHTML += `<tr><td>${weight} –∫–≥</td><td>${data.label}</td></tr>`;
    });
  }
}

/* WebAudio: —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π —Å–º–µ—Ö (–ø—Ä–∏ –æ—à–∏–±–∫–µ) */
let audioCtx = null;
function ensureAudioContext() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  if (audioCtx.state === 'suspended') audioCtx.resume().catch(()=>{});
  return audioCtx;
}

function playDuckLikeLaugh() {
  const ctx = ensureAudioContext();
  const now = ctx.currentTime + 0.01;
  const master = ctx.createGain(); master.gain.value = 0.8; master.connect(ctx.destination);

  const noiseBuf = ctx.createBuffer(1, Math.floor(ctx.sampleRate * 0.08), ctx.sampleRate);
  const data = noiseBuf.getChannelData(0);
  for (let i=0;i<data.length;i++) data[i] = (Math.random()*2-1)*(1 - i/data.length);
  const noise = ctx.createBufferSource(); noise.buffer = noiseBuf;
  const nf = ctx.createBiquadFilter(); nf.type='bandpass'; nf.frequency.value = 1200;
  noise.connect(nf); nf.connect(master);
  noise.start(now); noise.stop(now + 0.08);

  const syllables = [{t:0,f:200,d:0.16},{t:0.17,f:260,d:0.13},{t:0.33,f:320,d:0.11}];
  syllables.forEach(s=>{
    const o1 = ctx.createOscillator(); o1.type='square'; o1.frequency.setValueAtTime(s.f, now + s.t);
    const o2 = ctx.createOscillator(); o2.type='sawtooth'; o2.frequency.setValueAtTime(s.f*1.02, now + s.t);
    const g = ctx.createGain(); g.gain.setValueAtTime(0.0001, now + s.t);
    g.gain.exponentialRampToValueAtTime(0.45, now + s.t + 0.02);
    g.gain.exponentialRampToValueAtTime(0.0001, now + s.t + s.d);
    const fil = ctx.createBiquadFilter(); fil.type='lowpass'; fil.frequency.setValueAtTime(2200, now + s.t);
    o1.connect(g); o2.connect(g); g.connect(fil); fil.connect(master);
    o1.start(now + s.t); o1.stop(now + s.t + s.d + 0.02);
    o2.start(now + s.t); o2.stop(now + s.t + s.d + 0.02);
  });

  const bass = ctx.createOscillator(); bass.type='sine'; bass.frequency.setValueAtTime(90, now + 0.46);
  const gb = ctx.createGain(); gb.gain.setValueAtTime(0.0001, now + 0.46);
  gb.gain.linearRampToValueAtTime(0.35, now + 0.46 + 0.01);
  gb.gain.exponentialRampToValueAtTime(0.0001, now + 0.46 + 0.26);
  bass.connect(gb); gb.connect(master);
  bass.start(now + 0.46); bass.stop(now + 0.46 + 0.28);
}

function showError(message) {
  const errorDiv = document.getElementById("error-message");
  errorDiv.innerText = message;
  errorDiv.classList.add("show");
  try { playDuckLikeLaugh(); } catch (e) {}
  setTimeout(()=>{ errorDiv.classList.remove("show"); }, 1500);
}

/* ===================== –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ===================== */
function escapeHtml(text) {
  const map = {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#039;"};
  return String(text).replace(/[&<>"']/g, function(m){return map[m];});
}

function loadCustomExercisesToUI() {
  const list = loadCustomList();
  list.forEach(ex => createCustomResultBlock(ex));
  if (list.length > 0) document.getElementById('results').style.display = 'block';
}

/* ===================== –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã ===================== */
window.onload = function() {
  // —Ç–µ–º–∞
  const savedTheme = localStorage.getItem("theme");
  if (savedTheme === "light") {
    document.body.classList.add("light-theme");
    document.querySelector(".theme-toggle").textContent = "‚òÄÔ∏è";
  } else {
    document.querySelector(".theme-toggle").textContent = "üåô";
  }

  // –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–ª—è –∏ —É–∂–µ –ø–æ—Å—á–∏—Ç–∞–µ–º –∏—Ö (–Ω–æ –Ω–µ –±—É–¥–µ–º —Ç—Ä–æ–≥–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ)
  restoreDefaultInputs();
  // –µ—Å–ª–∏ –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑–∞—Ç—å –∏—Ö —Ä–∞—Å—á—ë—Ç—ã
  const anyDefaultFilled = defaultIds.some(id => {
    const v = document.getElementById(id).value;
    return v !== null && v !== "";
  });
  if (anyDefaultFilled) calculateWeights();

  // –∑–∞–≥—Ä—É–∑–∏–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏–∑ localStorage –∏ –æ—Ç—Ä–∏—Å—É–µ–º –∏—Ö
  loadCustomExercisesToUI();

  // –≤—ã–ø–∞–¥–∞—é—â–∏–µ –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é
  document.querySelectorAll(".dropdown > a").forEach(el=>{
    el.addEventListener("click",e=>{
      e.preventDefault();
      el.parentElement.classList.toggle("open");
    });
  });
};
</script>
</body>
</html>






